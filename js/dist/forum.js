(()=>{var t={n:o=>{var e=o&&o.__esModule?()=>o.default:()=>o;return t.d(e,{a:e}),e},d:(o,e)=>{for(var n in e)t.o(e,n)&&!t.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:e[n]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o)};(()=>{"use strict";const o=flarum.core.compat["forum/app"];var e=t.n(o);const n=flarum.core.compat["common/extend"],a=flarum.core.compat["forum/utils/DiscussionControls"];var r=t.n(a);const c=flarum.core.compat["common/components/Button"];var s=t.n(c);const i=flarum.core.compat["tags/forum/components/TagDiscussionModal"];var l=t.n(i);const u=flarum.core.compat["tags/forum/components/TagSelectionModal"];var f=t.n(u);function p(t,o){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},p(t,o)}const g=flarum.core.compat["common/utils/classList"];var d=t.n(g);const h=flarum.core.compat["common/helpers/highlight"];var v=t.n(h);const b=flarum.core.compat["common/components/LoadingIndicator"];var T=t.n(b);const y=flarum.core.compat["tags/common/helpers/tagIcon"];var S=t.n(y);const I=flarum.core.compat["tags/common/utils/sortTags"];var _=t.n(I),N=function(t){function o(){return t.apply(this,arguments)||this}var n,a;a=t,(n=o).prototype=Object.create(a.prototype),n.prototype.constructor=n,p(n,a);var r=o.prototype;return r.view=function(o){return t.prototype.view.call(this,o)},r.content=function(){var o,n,a=this;if(this.loading)return m(T(),null);var r=(this.attrs.selectableTags?this.attrs.selectableTags():this.tags)||[],c=(null==(o=this.filter)?void 0:o.call(this))||"",s=this.attrs.canSelect||function(){return!0},i=r.filter(function(t){return s(t)}),l=i.filter(function(t){return!c||(t.name()+" "+(t.description()||"")).toLowerCase().includes(c.toLowerCase())}),u=e().forum.attribute("tagCategories")||[],f=new Map(l.map(function(t){return[t.id(),t]})),p=u.map(function(t){var o=(t.tagIds||[]).map(function(t){return f.get(t)}).filter(Boolean);return{group:t,tags:_()(o.slice())}}).filter(function(t){return t.tags.length>0}),g=new Set;p.forEach(function(t){return t.tags.forEach(function(t){return g.add(t.id())})});var d=_()(l.filter(function(t){return!g.has(t.id())}));if(!p.length&&!d.length)return t.prototype.content.call(this);var h=t.prototype.content.call(this)[0],v=function(t,o){return m("div",{className:"lbtc-GroupSection"},m("div",{className:"lbtc-GroupSection-title"},t),m("ul",{className:"TagSelectionModal-list SelectTagList"},o.map(function(t){return a.renderTagItem(t,c)})))};return[h,m("div",{className:"Modal-footer lbtc-GroupedTagSelection"},p.map(function(t){var o=t.group,e=t.tags;return v(o.name,e)}),d.length?v(e().translator.trans("lady-byron-tag-categories.forum.tag_selection.ungrouped"),d):null,null!=(n=this.attrs.limits)&&n.allowBypassing?m("div",{className:"TagSelectionModal-controls"},m("button",{className:"Button",onclick:function(){return a.bypassReqs=!a.bypassReqs}},e().translator.trans("flarum-tags.lib.tag_selection_modal.bypass_requirements"))):null)]},r.renderTagItem=function(t,o){var e=this,n=this.indexTag===t,a=this.selected.includes(t);return m("li",{"data-index":t.id(),className:d()("SelectTagListItem",{pinned:null!==t.position(),child:!!t.parent(),colored:!!t.color(),selected:a,active:n}),style:{color:t.color()||void 0},onmouseover:function(){return e.indexTag=t},onclick:function(){return e.toggleTag(t)}},m("i",{className:"SelectTagListItem-icon"},S()(t,{className:"SelectTagListItem-tagIcon"}),m("i",{className:"icon TagIcon fas fa-check SelectTagListItem-checkIcon"})),m("span",{className:"SelectTagListItem-name"},v()(t.name(),o)),t.description()?m("span",{className:"SelectTagListItem-description"},t.description()):null)},o}(l());e().initializers.add("lady-byron/tag-categories",function(){var t=e().modal.show.bind(e().modal);e().modal.show=function(o,n){return!(e().forum.attribute("tagCategories")||[]).length||o!==l()&&o!==f()||(o=N),t(o,n)},(0,n.extend)(r(),"moderationControls",function(t,o){o.canTag&&o.canTag()&&t.add("tags",m(s(),{icon:"fas fa-tag",onclick:function(){return e().modal.show(N,{discussion:o})}},e().translator.trans("flarum-tags.forum.discussion_controls.edit_tags_button")),100)})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map