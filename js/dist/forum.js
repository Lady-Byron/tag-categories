(()=>{var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";const e=flarum.core.compat["forum/app"];var o=t.n(e);const n=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/utils/DiscussionControls"];var a=t.n(r);const s=flarum.core.compat["common/components/Button"];var l=t.n(s);const c=flarum.core.compat["tags/forum/components/TagDiscussionModal"];var i=t.n(c);const u=flarum.core.compat["tags/forum/components/TagSelectionModal"];var d=t.n(u);function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}const p=flarum.core.compat["common/utils/classList"];var f=t.n(p);const h=flarum.core.compat["common/helpers/highlight"];var b=t.n(h);const v=flarum.core.compat["common/components/LoadingIndicator"];var y=t.n(v);const T=flarum.core.compat["tags/common/helpers/tagIcon"];var _=t.n(T);const N=flarum.core.compat["tags/common/utils/sortTags"];var S=t.n(N),w=function(t){function e(){return t.apply(this,arguments)||this}var n,r;r=t,(n=e).prototype=Object.create(r.prototype),n.prototype.constructor=n,g(n,r);var a=e.prototype;return a.view=function(e){return t.prototype.view.call(this,e)},a.content=function(){var e,n,r=this;if(this.loading)return m(y(),null);var a=this.attrs.selectableTags?this.attrs.selectableTags():this.tags||[],s=this.attrs.canSelect||function(){return!0},l=a.filter(function(t){return s(t)}),c=this.filter&&this.filter()||"",i=c?l.filter(function(t){return((t.name()||"")+" "+(t.description()||"")).toLowerCase().includes(c.toLowerCase())}):l,u=new Map;i.forEach(function(t){return u.set(Number(t.id()),t)});var d=(o().forum.attribute("tagCategories")||[]).slice();d.sort(function(t,e){var o,n;return(null!=(o=t.order)?o:99999)-(null!=(n=e.order)?n:99999)||t.id-e.id});var g=d.map(function(t){var e=(t.tagIds||[]).map(function(t){return u.get(Number(t))}).filter(Boolean);return{g:t,tags:S()(e)}}).filter(function(t){return t.tags.length>0}),p=new Set;g.forEach(function(t){return t.tags.forEach(function(t){return p.add(Number(t.id()))})});var f=S()(i.filter(function(t){return!p.has(Number(t.id()))}));if(!g.length&&!f.length)return t.prototype.content.call(this);var h=o().translator.trans("flarum-tags.lib.tag_selection_modal.search_placeholder");return m("div",{className:"TagSelectionModal"},m("div",{className:"Form-group TagSelectionModal-toolbar"},m("input",{className:"FormControl",placeholder:h,value:this.filter?this.filter():"",oninput:function(t){return r.filter&&r.filter(t.target.value)}}),m("div",{className:"ButtonGroup"},this.attrs.allowResetting&&null!=(e=this.selected)&&e.length?m("button",{className:"Button",onclick:function(){return r.deselectAll()}},o().translator.trans("flarum-tags.lib.tag_selection_modal.reset_button")):null,m("button",{className:"Button Button--primary",onclick:function(){return r.onsubmit()}},o().translator.trans("flarum-tags.lib.tag_selection_modal.submit_button")))),g.map(function(t){var e=t.g,o=t.tags;return m("div",{className:"Form-group lbtc-GroupSection",key:e.id},m("div",{className:"lbtc-GroupSection-title"},e.name),m("ul",{className:"TagSelectionModal-list SelectTagList"},o.map(function(t){return r.renderTagItem(t,c)})))}),f.length?m("div",{className:"Form-group lbtc-GroupSection lbtc-GroupSection--ungrouped"},m("div",{className:"lbtc-GroupSection-title"},o().translator.trans("lady-byron-tag-categories.forum.tag_selection.ungrouped")),m("ul",{className:"TagSelectionModal-list SelectTagList"},f.map(function(t){return r.renderTagItem(t,c)}))):null,null!=(n=this.attrs.limits)&&n.allowBypassing?m("div",{className:"Form-group TagSelectionModal-bypass"},m("label",{className:"checkbox"},m("input",{type:"checkbox",checked:this.bypassReqs,onchange:function(){return r.bypassReqs=!r.bypassReqs}}),o().translator.trans("flarum-tags.lib.tag_selection_modal.bypass_requirements"))):null)},a.renderTagItem=function(t,e){var o=this,n=this.indexTag===t,r=this.selected&&this.selected.includes(t);return m("li",{key:t.id(),"data-index":t.id(),className:f()("SelectTagListItem",{pinned:null!==t.position(),child:!!t.parent(),colored:!!t.color(),selected:r,active:n}),style:{color:t.color()||void 0},onmouseover:function(){return o.indexTag=t},onclick:function(){return o.toggleTag(t)}},_()(t),m("span",{className:"SelectTagListItem-name"},b()(t.name()||"",e)),t.description()?m("span",{className:"SelectTagListItem-description"},t.description()):null)},e}(i());o().initializers.add("lady-byron/tag-categories",function(){var t=o().modal.show.bind(o().modal);o().modal.show=function(e,n){return!(o().forum.attribute("tagCategories")||[]).length||e!==i()&&e!==d()||(e=w),t(e,n)},(0,n.extend)(a(),"moderationControls",function(t,e){e.canTag&&e.canTag()&&t.add("tags",m(l(),{icon:"fas fa-tag",onclick:function(){return o().modal.show(w,{discussion:e})}},o().translator.trans("flarum-tags.forum.discussion_controls.edit_tags_button")),100)})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map