(()=>{var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";const e=flarum.core.compat["forum/app"];var n=t.n(e);const o=flarum.core.compat["common/extend"],a=flarum.core.compat["forum/utils/DiscussionControls"];var r=t.n(a);const s=flarum.core.compat["common/components/Button"];var l=t.n(s);const c=flarum.core.compat["tags/forum/components/TagDiscussionModal"];var i=t.n(c);function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}const d=flarum.core.compat["common/utils/classList"];var p=t.n(d);const g=flarum.core.compat["common/helpers/highlight"];var f=t.n(g);const h=flarum.core.compat["common/components/LoadingIndicator"];var v=t.n(h);const b=flarum.core.compat["tags/common/helpers/tagIcon"];var y=t.n(b);const T=flarum.core.compat["tags/common/utils/sortTags"];var _=t.n(T),N=function(t){function e(){return t.apply(this,arguments)||this}var o,a;a=t,(o=e).prototype=Object.create(a.prototype),o.prototype.constructor=o,u(o,a);var r=e.prototype;return r.view=function(e){return t.prototype.view.call(this,e)},r.content=function(){var e,o,a,r,s=this;if(this.loading)return m(v(),null);var l=(this.attrs.selectableTags?this.attrs.selectableTags():this.tags)||[],c=(null==(e=this.filter)?void 0:e.call(this))||"",i=this.attrs.canSelect||function(){return!0},u=l.filter(function(t){return i(t)}),d=u.filter(function(t){return!c||(t.name()+" "+(t.description()||"")).toLowerCase().includes(c.toLowerCase())}),p=n().forum.attribute("tagCategories")||[],g=new Map(d.map(function(t){return[t.id(),t]})),f=p.map(function(t){var e=(t.tagIds||[]).map(function(t){return g.get(t)}).filter(Boolean);return{group:t,tags:_()(e.slice())}}).filter(function(t){return t.tags.length>0}),h=new Set;f.forEach(function(t){return t.tags.forEach(function(t){return h.add(t.id())})});var b=_()(d.filter(function(t){return!h.has(t.id())}));return f.length||b.length?m("div",{className:"Modal-content TagSelectionModal lbtc-GroupedTagSelection"},m("div",{className:"Modal-header"},m("h3",{className:"App-titleControl App-titleControl--text"},this.attrs.title),m("input",{className:"FormControl",placeholder:n().translator.trans("flarum-tags.lib.tag_selection_modal.search_placeholder"),value:null==(o=this.filter)?void 0:o.call(this),oninput:function(t){return null==s.filter?void 0:s.filter(t.target.value)}}),m("div",{className:"ButtonGroup"},this.attrs.allowResetting&&null!=(a=this.selected)&&a.length?m("button",{className:"Button",onclick:function(){return s.deselectAll()}},n().translator.trans("flarum-tags.lib.tag_selection_modal.reset_button")):null,m("button",{className:"Button Button--primary",onclick:function(){return s.onsubmit()}},n().translator.trans("flarum-tags.lib.tag_selection_modal.submit_button")))),m("div",{className:"Modal-body"},f.map(function(t){var e=t.group,n=t.tags;return m("div",{className:"lbtc-GroupSection"},m("div",{className:"lbtc-GroupSection-title"},e.name),m("ul",{className:"TagSelectionModal-list SelectTagList"},n.map(function(t){return s.renderTagItem(t,c)})))}),b.length?m("div",{className:"lbtc-GroupSection"},m("div",{className:"lbtc-GroupSection-title"},n().translator.trans("lady-byron-tag-categories.forum.tag_selection.ungrouped")),m("ul",{className:"TagSelectionModal-list SelectTagList"},b.map(function(t){return s.renderTagItem(t,c)}))):null,null!=(r=this.attrs.limits)&&r.allowBypassing?m("div",{className:"TagSelectionModal-bypass"},m("label",{class:"checkbox"},m("input",{type:"checkbox",checked:this.bypassReqs,onchange:function(){return s.bypassReqs=!s.bypassReqs}}),n().translator.trans("flarum-tags.lib.tag_selection_modal.bypass_requirements"))):null)):t.prototype.content.call(this)},r.renderTagItem=function(t,e){var n=this,o=this.indexTag===t,a=this.selected.includes(t);return m("li",{"data-index":t.id(),className:p()("SelectTagListItem",{pinned:null!==t.position(),child:!!t.parent(),colored:!!t.color(),selected:a,active:o}),style:{color:t.color()||void 0},onmouseover:function(){return n.indexTag=t},onclick:function(){return n.toggleTag(t)}},y()(t),m("span",{className:"SelectTagListItem-name"},f()(t.name(),e)),t.description()?m("span",{className:"SelectTagListItem-description"},t.description()):null)},e}(i());n().initializers.add("lady-byron/tag-categories",function(){var t=n().modal.show.bind(n().modal);n().modal.show=function(e,n){return e===i()&&(e=N),t(e,n)},(0,o.extend)(r(),"moderationControls",function(t,e){e.canTag&&e.canTag()&&t.add("tags",m(l(),{icon:"fas fa-tag",onclick:function(){return n().modal.show(N,{discussion:e})}},n().translator.trans("flarum-tags.forum.discussion_controls.edit_tags_button")),100)})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map