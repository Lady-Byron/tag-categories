/*! For license information please see admin.js.LICENSE.txt */
(()=>{var t={24:(t,r,e)=>{var n=e(163),o=e(110),a=e(996),s=e(312),i=e(166),u=e(766),c=e(760);function l(){"use strict";var r=o(),e=r.m(l),d=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function p(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===d||"GeneratorFunction"===(r.displayName||r.name))}var f={throw:1,return:2,break:3,continue:3};function m(t){var r,e;return function(n){r||(r={stop:function(){return e(n.a,2)},catch:function(){return n.v},abrupt:function(t,r){return e(n.a,f[t],r)},delegateYield:function(t,o,a){return r.resultName=o,e(n.d,c(t),a)},finish:function(t){return e(n.f,t)}},e=function(t,e,o){n.p=r.prev,n.n=r.next;try{return t(e,o)}finally{r.next=n.n}}),r.resultName&&(r[r.resultName]=n.v,r.resultName=void 0),r.sent=n.v,r.next=n.n;try{return t.call(this,r)}finally{n.p=r.prev,n.n=r.next}}}return(t.exports=l=function(){return{wrap:function(t,e,n,o){return r.w(m(t),e,n,o&&o.reverse())},isGeneratorFunction:p,mark:r.m,awrap:function(t,r){return new n(t,r)},AsyncIterator:i,async:function(t,r,e,n,o){return(p(r)?s:a)(m(t),r,e,n,o)},keys:u,values:c}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=l,t.exports.__esModule=!0,t.exports.default=t.exports},110:(t,r,e)=>{var n=e(397);function o(){var r,e,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function u(t,o,a,s){var i=o&&o.prototype instanceof l?o:l,u=Object.create(i.prototype);return n(u,"_invoke",function(t,n,o){var a,s,i,u=0,l=o||[],d=!1,p={p:0,n:0,v:r,a:f,f:f.bind(r,4),d:function(t,e){return a=t,s=0,i=r,p.n=e,c}};function f(t,n){for(s=t,i=n,e=0;!d&&u&&!o&&e<l.length;e++){var o,a=l[e],f=p.p,m=a[2];t>3?(o=m===n)&&(i=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=r):a[0]<=f&&((o=t<2&&f<a[1])?(s=0,p.v=n,p.n=a[1]):f<m&&(o=t<3||a[0]>n||n>m)&&(a[4]=t,a[5]=n,p.n=m,s=0))}if(o||t>1)return c;throw d=!0,n}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,m),s=l,i=m;(e=s<2?r:i)||!d;){a||(s?s<3?(s>1&&(p.n=-1),f(s,i)):p.n=i:p.v=i);try{if(u=2,a){if(s||(o="next"),e=a[o]){if(!(e=e.call(a,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=r}else if((e=(d=p.n<0)?i:t.call(n,p))!==c)break}catch(t){a=r,s=1,i=t}finally{u=1}}return{value:e,done:d}}}(t,a,s),!0),u}var c={};function l(){}function d(){}function p(){}e=Object.getPrototypeOf;var f=[][s]?e(e([][s]())):(n(e={},s,function(){return this}),e),m=p.prototype=l.prototype=Object.create(f);function g(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,n(t,i,"GeneratorFunction")),t.prototype=Object.create(m),t}return d.prototype=p,n(m,"constructor",p),n(p,"constructor",d),d.displayName="GeneratorFunction",n(p,i,"GeneratorFunction"),n(m),n(m,i,"Generator"),n(m,s,function(){return this}),n(m,"toString",function(){return"[object Generator]"}),(t.exports=o=function(){return{w:u,m:g}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},163:t=>{t.exports=function(t,r){this.v=t,this.k=r},t.exports.__esModule=!0,t.exports.default=t.exports},166:(t,r,e)=>{var n=e(163),o=e(397);t.exports=function t(r,e){function a(t,o,s,i){try{var u=r[t](o),c=u.value;return c instanceof n?e.resolve(c.v).then(function(t){a("next",t,s,i)},function(t){a("throw",t,s,i)}):e.resolve(c).then(function(t){u.value=t,s(u)},function(t){return a("throw",t,s,i)})}catch(t){i(t)}}var s;this.next||(o(t.prototype),o(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),o(this,"_invoke",function(t,r,n){function o(){return new e(function(r,e){a(t,n,r,e)})}return s=s?s.then(o,o):o()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports},183:(t,r,e)=>{var n=e(24)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},312:(t,r,e)=>{var n=e(110),o=e(166);t.exports=function(t,r,e,a,s){return new o(n().w(t,r,e,a),s||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports},397:t=>{function r(e,n,o,a){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}t.exports=r=function(t,e,n,o){function a(e,n){r(t,e,function(t){return this._invoke(e,n,t)})}e?s?s(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,r(e,n,o,a)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},735:t=>{function r(e){return t.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},760:(t,r,e)=>{var n=e(735).default;t.exports=function(t){if(null!=t){var r=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(n(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports},766:t=>{t.exports=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports},996:(t,r,e)=>{var n=e(312);t.exports=function(t,r,e,o,a){var s=n(t,r,e,o,a);return s.next().then(function(t){return t.done?t.value:s.next()})},t.exports.__esModule=!0,t.exports.default=t.exports}},r={};function e(n){var o=r[n];if(void 0!==o)return o.exports;var a=r[n]={exports:{}};return t[n](a,a.exports,e),a.exports}e.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},e.d=(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},e.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";e.r(n),e.d(n,{moduleName:()=>P});const t=flarum.core.compat["admin/app"];var r=e.n(t);function o(t,r,e,n,o,a,s){try{var i=t[a](s),u=i.value}catch(t){return void e(t)}i.done?r(u):Promise.resolve(u).then(n,o)}function a(t){return function(){var r=this,e=arguments;return new Promise(function(n,a){var s=t.apply(r,e);function i(t){o(s,n,a,i,u,"next",t)}function u(t){o(s,n,a,i,u,"throw",t)}i(void 0)})}}var s=e(183),i=e.n(s);const u=flarum.core.compat["common/components/Button"];var c=e.n(u);const l=flarum.core.compat["common/components/LoadingIndicator"];var d=e.n(l);const p=flarum.core.compat["common/helpers/icon"];var f=e.n(p);function g(t,r){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},g(t,r)}function h(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,g(t,r)}const v=flarum.core.compat["common/components/Modal"];var y=e.n(v);const b=flarum.core.compat["common/utils/Stream"];var x=e.n(b),w=function(t){function e(){for(var r,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(r=t.call.apply(t,[this].concat(n))||this).name=x()(""),r.slug=x()(""),r.description=x()(""),r.order=x()(""),r}h(e,t);var n=e.prototype;return n.oninit=function(r){var e,n,o;t.prototype.oninit.call(this,r);var a=this.attrs.group;this.name(null!=(e=null==a||null==a.name?void 0:a.name())?e:""),this.slug(null!=(n=null==a||null==a.slug?void 0:a.slug())?n:""),this.description(null!=(o=null==a||null==a.description?void 0:a.description())?o:""),this.order(null!=(null==a||null==a.order?void 0:a.order())?String(a.order()):"")},n.className=function(){return"EditGroupModal Modal--small"},n.title=function(){return this.attrs.group?r().translator.trans("lady-byron-tag-categories.admin.page.edit"):r().translator.trans("lady-byron-tag-categories.admin.page.create")},n.content=function(){var t=this;return m("div",{class:"Modal-body"},m("div",{class:"Form"},m("div",{class:"Form-group"},m("label",null,r().translator.trans("lady-byron-tag-categories.admin.page.name")),m("input",{class:"FormControl",bidi:this.name})),m("div",{class:"Form-group"},m("label",null,r().translator.trans("lady-byron-tag-categories.admin.page.slug")),m("input",{class:"FormControl",bidi:this.slug,placeholder:"auto-generated if empty"})),m("div",{class:"Form-group"},m("label",null,r().translator.trans("lady-byron-tag-categories.admin.page.description")),m("textarea",{class:"FormControl",rows:3,bidi:this.description})),m("div",{class:"Form-group"},m("label",null,r().translator.trans("lady-byron-tag-categories.admin.page.order")),m("input",{class:"FormControl",type:"number",bidi:this.order})),m("div",{class:"Form-group"},m(c(),{className:"Button Button--primary",onclick:function(){return t.save()}},r().translator.trans("lady-byron-tag-categories.admin.page.save")))))},n.save=function(){var t=a(i().mark(function t(){var e,n,o;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e={name:this.name(),slug:this.slug()||null,description:this.description()||null,order:""===this.order()?null:parseInt(this.order(),10)},this.loading=!0,m.redraw(),t.prev=1,!this.attrs.group){t.next=3;break}return t.next=2,r().request({method:"PATCH",url:r().forum.attribute("apiUrl")+"/tag-categories/"+this.attrs.group.id(),body:{data:{attributes:e}}});case 2:t.next=4;break;case 3:return t.next=4,r().request({method:"POST",url:r().forum.attribute("apiUrl")+"/tag-categories",body:{data:{attributes:e}}});case 4:this.hide(),null==(n=(o=this.attrs).onsave)||n.call(o);case 5:return t.prev=5,this.loading=!1,m.redraw(),t.finish(5);case 6:case"end":return t.stop()}},t,this,[[1,,5,6]])}));return function(){return t.apply(this,arguments)}}(),e}(y()),_=function(t){function e(){for(var r,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(r=t.call.apply(t,[this].concat(n))||this).ready=!1,r.allTags=[],r.selectedIds=new Set,r}h(e,t);var n=e.prototype;return n.className=function(){return"AssignTagsModal Modal--medium"},n.title=function(){return r().translator.trans("lady-byron-tag-categories.admin.page.assign_tags")},n.oninit=function(){var e=a(i().mark(function e(n){var o,a,s,u=this;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.oninit.call(this,n),e.next=1,r().store.find("tags",{include:"parent",page:{limit:999}});case 1:return this.allTags=r().store.all("tags"),e.next=2,r().request({method:"GET",url:r().forum.attribute("apiUrl")+"/tag-categories?include=tags"});case 2:o=e.sent,r().store.pushPayload(o),a=r().store.getById("tag-category-groups",this.attrs.group.id()),(s=null==a||null==a.tags?void 0:a.tags())&&s.forEach(function(t){return u.selectedIds.add(t.id())}),this.ready=!0,m.redraw();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.content=function(){var t=this;if(!this.ready)return m("div",{class:"Modal-body"},m("p",null,"Loading..."));var e=this.allTags.filter(function(t){return!t.isChild()}),n=this.allTags.filter(function(t){return t.isChild()}),o=function(r,e){return m("div",{class:"Form-group"},m("h4",null,r),m("div",{class:"CheckboxGrid"},e.map(function(r){return m("label",{class:"checkbox"},m("input",{type:"checkbox",checked:t.selectedIds.has(r.id()),onchange:function(e){return t.toggle(r,e.target.checked)}}),m("span",null,r.name()))})))};return m("div",{class:"Modal-body"},m("div",{class:"Form"},o("Primary Tags",e),o("Secondary Tags",n),m("div",{class:"Form-group"},m(c(),{className:"Button Button--primary",onclick:function(){return t.save()}},r().translator.trans("lady-byron-tag-categories.admin.page.save")))))},n.toggle=function(t,r){var e=t.id();r?this.selectedIds.add(e):this.selectedIds.delete(e)},n.save=function(){var t=a(i().mark(function t(){var e;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=Array.from(this.selectedIds.values()),this.loading=!0,m.redraw(),t.prev=1,t.next=2,r().request({method:"PATCH",url:r().forum.attribute("apiUrl")+"/tag-categories/"+this.attrs.group.id()+"/tags",body:{data:{attributes:{tagIds:e}}}});case 2:this.hide(),this.attrs.onsave&&this.attrs.onsave();case 3:return t.prev=3,this.loading=!1,m.redraw(),t.finish(3);case 4:case"end":return t.stop()}},t,this,[[1,,3,4]])}));return function(){return t.apply(this,arguments)}}(),e}(y()),T=function(){function t(){this.loading=!0,this.groups=[],this.dirtyOrder=!1}var e=t.prototype;return e.oninit=function(t){this.load()},e.view=function(){var t=this;return this.loading?m(d(),null):m("div",{class:"lbtc-TagCategoriesPage"},m("div",{class:"container"},m("div",{class:"Form-group"},m("h2",null,r().translator.trans("lady-byron-tag-categories.admin.page.heading")),m("div",{class:"helpText"},r().translator.trans("lady-byron-tag-categories.admin.page.reorder_help"))),m("div",{class:"Form-group"},m(c(),{className:"Button Button--primary",onclick:function(){return t.openCreate()}},f()("fas fa-plus")," ",r().translator.trans("lady-byron-tag-categories.admin.page.create"))," ",m(c(),{disabled:!this.dirtyOrder,className:"Button",onclick:function(){return t.saveOrder()}},f()("fas fa-save")," ",r().translator.trans("lady-byron-tag-categories.admin.page.save"))),m("div",{class:"Form-group"},m("ul",{class:"TagCategoriesList"},this.groups.map(function(e,n){return m("li",{class:"TagCategoriesListItem","data-id":e.id(),key:e.id()},m("div",{class:"TagCategoriesListItem-main"},m("div",{class:"TagCategoriesListItem-title"},m("strong",null,e.name()),e.slug()?m("span",{class:"TagCategoriesListItem-slug"},"/",e.slug()):null),e.description()?m("div",{class:"TagCategoriesListItem-desc"},e.description()):null),m("div",{class:"TagCategoriesListItem-actions"},m(c(),{className:"Button",icon:"fas fa-arrow-up",disabled:0===n,onclick:function(){return t.move(n,-1)}}),m(c(),{className:"Button",icon:"fas fa-arrow-down",disabled:n===t.groups.length-1,onclick:function(){return t.move(n,1)}}),m(c(),{className:"Button",onclick:function(){return t.openAssign(e)},icon:"fas fa-list-check"},r().translator.trans("lady-byron-tag-categories.admin.page.assign_tags")),m(c(),{className:"Button",onclick:function(){return t.openEdit(e)},icon:"fas fa-pen"},r().translator.trans("lady-byron-tag-categories.admin.page.edit")),m(c(),{className:"Button Button--danger",onclick:function(){return t.remove(e)},icon:"fas fa-trash"},r().translator.trans("lady-byron-tag-categories.admin.page.delete"))))})))))},e.load=function(){var t=a(i().mark(function t(){var e;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,m.redraw(),t.prev=1,t.next=2,r().request({method:"GET",url:r().forum.attribute("apiUrl")+"/tag-categories"});case 2:e=t.sent,this.groups=r().store.pushPayload(e).toArray?r().store.pushPayload(e).toArray():r().store.all("tag-category-groups"),this.groups.sort(function(t,r){var e,n,o=null!=(e=t.order())?e:Number.MAX_SAFE_INTEGER,a=null!=(n=r.order())?n:Number.MAX_SAFE_INTEGER;return o!==a?o-a:t.id()-r.id()}),this.dirtyOrder=!1;case 3:return t.prev=3,this.loading=!1,m.redraw(),t.finish(3);case 4:case"end":return t.stop()}},t,this,[[1,,3,4]])}));return function(){return t.apply(this,arguments)}}(),e.move=function(t,r){var e=t+r;if(!(e<0||e>=this.groups.length)){var n=this.groups[t];this.groups[t]=this.groups[e],this.groups[e]=n,this.dirtyOrder=!0}},e.saveOrder=function(){var t=a(i().mark(function t(){var e,n;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.groups.map(function(t){return t.id()}),this.loading=!0,m.redraw(),t.prev=1,t.next=2,r().request({method:"PATCH",url:r().forum.attribute("apiUrl")+"/tag-categories/order",body:{data:{attributes:{ids:e}}}});case 2:return n=t.sent,r().store.pushPayload(n),t.next=3,this.load();case 3:return t.prev=3,this.loading=!1,m.redraw(),t.finish(3);case 4:case"end":return t.stop()}},t,this,[[1,,3,4]])}));return function(){return t.apply(this,arguments)}}(),e.openCreate=function(){var t=this;r().modal.show(w,{onsave:function(){return t.load()}})},e.openEdit=function(t){var e=this;r().modal.show(w,{group:t,onsave:function(){return e.load()}})},e.openAssign=function(t){var e=this;r().modal.show(_,{group:t,onsave:function(){return e.load()}})},e.remove=function(){var t=a(i().mark(function t(e){return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(confirm(r().translator.trans("lady-byron-tag-categories.admin.page.delete_confirm"))){t.next=1;break}return t.abrupt("return");case 1:return this.loading=!0,m.redraw(),t.prev=2,t.next=3,r().request({method:"DELETE",url:r().forum.attribute("apiUrl")+"/tag-categories/"+e.id()});case 3:this.groups=this.groups.filter(function(t){return t!==e});case 4:return t.prev=4,this.loading=!1,m.redraw(),t.finish(4);case 5:case"end":return t.stop()}},t,this,[[2,,4,5]])}));return function(r){return t.apply(this,arguments)}}(),t}();const k=flarum.core.compat["common/Model"];var O=e.n(k),M=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(r=t.call.apply(t,[this].concat(n))||this).name=O().attribute("name"),r.slug=O().attribute("slug"),r.description=O().attribute("description"),r.order=O().attribute("order"),r.tags=O().hasMany("tags"),r}return h(r,t),r}(O()),P="lady-byron-tag-categories";r().initializers.add(P,function(){r().store.models["tag-category-groups"]=M,r().extensionData.for(P).registerPage(T).registerPermission({icon:"fas fa-layer-group",label:r().translator.trans("lady-byron-tag-categories.admin.nav.title"),permission:"administrate"},"moderate",100),r().extensionData.for(P).registerSetting(function(){return m("div",{class:"helpText"},r().translator.trans("lady-byron-tag-categories.admin.nav.description"))})})})(),module.exports=n})();
//# sourceMappingURL=admin.js.map