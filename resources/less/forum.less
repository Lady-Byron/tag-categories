// Forum grouped tag selection visual helpers
.lbtc-GroupSection {
  margin: 8px 0 16px;
}
.lbtc-GroupSection-title {
  font-weight: 600;
  margin-bottom: 6px;
}

// 只对可折叠的标题应用交互样式
.TagSelectionModal-groupHeader:not(.non-collapsible) {
  cursor: pointer;
  user-select: none;
}

.TagSelectionModal-groupHeader {
  position: relative;

  .TagSelectionModal-groupHeader-caret {
    margin-right: 8px;
    transition: transform 0.2s ease-in-out;
    font-size: 0.9em;
    color: #666;
  }

  // 当分组被折叠时
  &.collapsed {
    .TagSelectionModal-groupHeader-caret {
      transform: rotate(-90deg);
    }
  }
}


/* 全局（仅本弹窗）统一标题列宽 */
.Modal-content .TagSelectionModal {
  --tag-name-col: 16ch;
}

/* 整行：两列布局 */
.Modal-body  .TagSelectionModal-list.SelectTagList .SelectTagListItem,
.Modal-footer .TagSelectionModal-list.SelectTagList .SelectTagListItem {
  display: flex;
  align-items: center;
  gap: 8px;
  line-height: 1.2;
}

/* 图标微距（不影响对齐列） */
.Modal-body  .TagSelectionModal-list.SelectTagList .SelectTagListItem .TagIcon,
.Modal-footer .TagSelectionModal-list.SelectTagList .SelectTagListItem .TagIcon {
  margin-left: 0;
  margin-right: 8px;
  flex: 0 0 auto;
}

/* 标题列：固定列宽（使用统一变量） */
.Modal-body  .TagSelectionModal-list.SelectTagList .SelectTagListItem-name,
.Modal-footer .TagSelectionModal-list.SelectTagList .SelectTagListItem-name {
  display: inline;
  flex: 0 0 var(--tag-name-col);
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 描述列：紧跟其后、自适应；保持弱化色 */
.Modal-body  .TagSelectionModal-list.SelectTagList .SelectTagListItem-description,
.Modal-footer .TagSelectionModal-list.SelectTagList .SelectTagListItem-description {
  display: inline-block;
  flex: 1 1 auto;
  text-align: left;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: var(--muted-color) !important;
}

/* --- Flarum 标签选择弹窗 Duotone 图标对齐修复 --- */

/* 为 .fa-duotone 自身创建定位上下文，并规范其盒子模型 */
.TagSelectionModal .SelectTagListItem .fa-duotone {
  position: relative;
  display: inline-block;
  width: 1.25em;
  height: 1em;
  line-height: 1;
  vertical-align: middle;
}

/* 将两个伪元素（图标的两个图层）绝对定位于容器内 */
.TagSelectionModal .SelectTagListItem .fa-duotone::before,
.TagSelectionModal .SelectTagListItem .fa-duotone::after {
  position: absolute !important;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: block;
  line-height: 1;
  text-align: center;
}

/* 确保字体家族正确，防止因继承问题导致图标不显示 */
.TagSelectionModal .SelectTagListItem .fa-duotone,
.TagSelectionModal .SelectTagListItem .fa-duotone::before,
.TagSelectionModal .SelectTagListItem .fa-duotone::after {
  font-family: "Font Awesome 6 Duotone" !important;
  font-weight: 900;
}


/* 修正图标整体垂直对齐问题 */

/* 将图标的直接父容器 (.TagIcon) 变为 flex 容器，实现精确居中 */
.TagSelectionModal .SelectTagListItem .TagIcon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-style: normal;
}

/* 覆盖原始 CSS 中有问题的 line-height，消除对齐问题的根源 */
.TagSelectionModal .SelectTagListItem {
  line-height: normal;
}


/* === Mobile 备用方案：名称一行，描述换到下一行显示 === */
@media (max-width: 680px) {
  .Modal-content .TagSelectionModal {
    --tag-icon-w: 1.25em;
    --tag-gap: 8px;
  }

  .Modal-body  .TagSelectionModal-list.SelectTagList .SelectTagListItem,
  .Modal-footer .TagSelectionModal-list.SelectTagList .SelectTagListItem {
    display: flex;
    flex-wrap: wrap;
    align-items: baseline;
    gap: 6px 8px;
    line-height: normal;
  }

  .Modal-body  .TagSelectionModal-list.SelectTagList .SelectTagListItem .TagIcon,
  .Modal-footer .TagSelectionModal-list.SelectTagList .SelectTagListItem .TagIcon {
    flex: 0 0 auto;
    margin-left: 0;
    margin-right: var(--tag-gap);
  }

  .Modal-body  .TagSelectionModal-list.SelectTagList .SelectTagListItem-name,
  .Modal-footer .TagSelectionModal-list.SelectTagList .SelectTagListItem-name {
    flex: 1 1 auto;
    min-width: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .Modal-body  .TagSelectionModal-list.SelectTagList .SelectTagListItem-description,
  .Modal-footer .TagSelectionModal-list.SelectTagList .SelectTagListItem-description {
    display: block;
    flex: 1 1 100%;
    margin-left: calc(~"var(--tag-icon-w, 1.25em) + var(--tag-gap, 8px)");
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--muted-color) !important;
  }

  /* 避免桌面端遗留的固定列宽变量干扰移动端布局 */
  .Modal-content .TagSelectionModal { --tag-name-col: auto; }
}
